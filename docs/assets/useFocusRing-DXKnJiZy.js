import{e as k,k as fe,l as ce,m as J,d as j,$ as de,a as pe,n as ge,h as ve,o as Te,b as $e}from"./focusSafely-Cv_PksxV.js";import{f as oe,d as A,a as Pe}from"./platform-Dv8lzYqa.js";import{g as I,a as ae,l as be}from"./utils-9Msfu4Q8.js";import{d as Q}from"./openLink-D2-6eagY.js";import{r as v}from"./index-DVXBtNgz.js";function ye(){let t=v.useRef(new Map),n=v.useCallback((i,$,c,f)=>{let p=f!=null&&f.once?(...b)=>{t.current.delete(c),c(...b)}:c;t.current.set(c,{type:$,eventTarget:i,fn:p,options:f}),i.addEventListener($,c,f)},[]),a=v.useCallback((i,$,c,f)=>{var p;let b=((p=t.current.get(c))===null||p===void 0?void 0:p.fn)||c;i.removeEventListener($,b,f),t.current.delete(c)},[]),u=v.useCallback(()=>{t.current.forEach((i,$)=>{a(i.eventTarget,i.type,$,i.options)})},[a]);return v.useEffect(()=>u,[u]),{addGlobalListener:n,removeGlobalListener:a,removeAllGlobalListeners:u}}let _="default",z="",R=new WeakMap;function Z(t){if(oe()){if(_==="default"){const n=k(t);z=n.documentElement.style.webkitUserSelect,n.documentElement.style.webkitUserSelect="none"}_="disabled"}else(t instanceof HTMLElement||t instanceof SVGElement)&&(R.set(t,t.style.userSelect),t.style.userSelect="none")}function U(t){if(oe()){if(_!=="disabled")return;_="restoring",setTimeout(()=>{fe(()=>{if(_==="restoring"){const n=k(t);n.documentElement.style.webkitUserSelect==="none"&&(n.documentElement.style.webkitUserSelect=z||""),z="",_="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&R.has(t)){let n=R.get(t);t.style.userSelect==="none"&&(t.style.userSelect=n),t.getAttribute("style")===""&&t.removeAttribute("style"),R.delete(t)}}function he(t,n){return n.get?n.get.call(t):n.value}function ie(t,n,a){if(!n.has(t))throw new TypeError("attempted to "+a+" private field on non-instance");return n.get(t)}function Ee(t,n){var a=ie(t,n,"get");return he(t,a)}function me(t,n){if(n.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Se(t,n,a){me(t,n),n.set(t,a)}function xe(t,n,a){if(n.set)n.set.call(t,a);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=a}}function ee(t,n,a){var u=ie(t,n,"set");return xe(t,u,a),a}function Me(t){let n=v.useContext(de);if(n){let{register:a,...u}=n;t=ae(u,t),a()}return pe(n,t.ref),t}var G=new WeakMap;class V{continuePropagation(){ee(this,G,!1)}get shouldStopPropagation(){return Ee(this,G)}constructor(n,a,u){Se(this,G,{writable:!0,value:void 0}),ee(this,G,!0),this.type=n,this.pointerType=a,this.target=u.currentTarget,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.ctrlKey=u.ctrlKey,this.altKey=u.altKey}}const te=Symbol("linkClicked");function Ae(t){let{onPress:n,onPressChange:a,onPressStart:u,onPressEnd:i,onPressUp:$,isDisabled:c,isPressed:f,preventFocusOnPress:p,shouldCancelOnPointerExit:b,allowTextSelectionOnPress:P,ref:w,...m}=Me(t),[d,S]=v.useState(!1),h=v.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:C,removeAllGlobalListeners:F}=ye(),x=I((e,l)=>{let E=h.current;if(c||E.didFirePressStart)return!1;let o=!0;if(E.isTriggeringEvent=!0,u){let g=new V("pressstart",l,e);u(g),o=g.shouldStopPropagation}return a&&a(!0),E.isTriggeringEvent=!1,E.didFirePressStart=!0,S(!0),o}),y=I((e,l,E=!0)=>{let o=h.current;if(!o.didFirePressStart)return!1;o.ignoreClickAfterPress=!0,o.didFirePressStart=!1,o.isTriggeringEvent=!0;let g=!0;if(i){let r=new V("pressend",l,e);i(r),g=r.shouldStopPropagation}if(a&&a(!1),S(!1),n&&E&&!c){let r=new V("press",l,e);n(r),g&&(g=r.shouldStopPropagation)}return o.isTriggeringEvent=!1,g}),K=I((e,l)=>{let E=h.current;if(c)return!1;if($){E.isTriggeringEvent=!0;let o=new V("pressup",l,e);return $(o),E.isTriggeringEvent=!1,o.shouldStopPropagation}return!0}),O=I(e=>{let l=h.current;l.isPressed&&l.target&&(l.isOverTarget&&l.pointerType!=null&&y(M(l.target,e),l.pointerType,!1),l.isPressed=!1,l.isOverTarget=!1,l.activePointerId=null,l.pointerType=null,F(),P||U(l.target))}),D=I(e=>{b&&O(e)}),le=v.useMemo(()=>{let e=h.current,l={onKeyDown(o){if(W(o.nativeEvent,o.currentTarget)&&o.currentTarget.contains(o.target)){var g;ne(o.target,o.key)&&o.preventDefault();let r=!0;if(!e.isPressed&&!o.repeat){e.target=o.currentTarget,e.isPressed=!0,r=x(o,"keyboard");let s=o.currentTarget,T=L=>{W(L,s)&&!L.repeat&&s.contains(L.target)&&e.target&&K(M(e.target,L),"keyboard")};C(k(o.currentTarget),"keyup",be(T,E),!0)}r&&o.stopPropagation(),o.metaKey&&Pe()&&((g=e.metaKeyEvents)===null||g===void 0||g.set(o.key,o.nativeEvent))}else o.key==="Meta"&&(e.metaKeyEvents=new Map)},onClick(o){if(!(o&&!o.currentTarget.contains(o.target))&&o&&o.button===0&&!e.isTriggeringEvent&&!Q.isOpening){let g=!0;if(c&&o.preventDefault(),!e.ignoreClickAfterPress&&!e.ignoreEmulatedMouseEvents&&!e.isPressed&&(e.pointerType==="virtual"||J(o.nativeEvent))){!c&&!p&&A(o.currentTarget);let r=x(o,"virtual"),s=K(o,"virtual"),T=y(o,"virtual");g=r&&s&&T}e.ignoreEmulatedMouseEvents=!1,e.ignoreClickAfterPress=!1,g&&o.stopPropagation()}}},E=o=>{var g;if(e.isPressed&&e.target&&W(o,e.target)){var r;ne(o.target,o.key)&&o.preventDefault();let T=o.target;y(M(e.target,o),"keyboard",e.target.contains(T)),F(),o.key!=="Enter"&&q(e.target)&&e.target.contains(T)&&!o[te]&&(o[te]=!0,Q(e.target,o,!1)),e.isPressed=!1,(r=e.metaKeyEvents)===null||r===void 0||r.delete(o.key)}else if(o.key==="Meta"&&(!((g=e.metaKeyEvents)===null||g===void 0)&&g.size)){var s;let T=e.metaKeyEvents;e.metaKeyEvents=void 0;for(let L of T.values())(s=e.target)===null||s===void 0||s.dispatchEvent(new KeyboardEvent("keyup",L))}};if(typeof PointerEvent<"u"){l.onPointerDown=s=>{if(s.button!==0||!s.currentTarget.contains(s.target))return;if(ce(s.nativeEvent)){e.pointerType="virtual";return}X(s.currentTarget)&&s.preventDefault(),e.pointerType=s.pointerType;let T=!0;e.isPressed||(e.isPressed=!0,e.isOverTarget=!0,e.activePointerId=s.pointerId,e.target=s.currentTarget,!c&&!p&&A(s.currentTarget),P||Z(e.target),T=x(s,e.pointerType),C(k(s.currentTarget),"pointermove",o,!1),C(k(s.currentTarget),"pointerup",g,!1),C(k(s.currentTarget),"pointercancel",r,!1)),T&&s.stopPropagation()},l.onMouseDown=s=>{s.currentTarget.contains(s.target)&&s.button===0&&(X(s.currentTarget)&&s.preventDefault(),s.stopPropagation())},l.onPointerUp=s=>{!s.currentTarget.contains(s.target)||e.pointerType==="virtual"||s.button===0&&H(s,s.currentTarget)&&K(s,e.pointerType||s.pointerType)};let o=s=>{s.pointerId===e.activePointerId&&(e.target&&H(s,e.target)?!e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!0,x(M(e.target,s),e.pointerType)):e.target&&e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!1,y(M(e.target,s),e.pointerType,!1),D(s)))},g=s=>{s.pointerId===e.activePointerId&&e.isPressed&&s.button===0&&e.target&&(H(s,e.target)&&e.pointerType!=null?y(M(e.target,s),e.pointerType):e.isOverTarget&&e.pointerType!=null&&y(M(e.target,s),e.pointerType,!1),e.isPressed=!1,e.isOverTarget=!1,e.activePointerId=null,e.pointerType=null,F(),P||U(e.target))},r=s=>{O(s)};l.onDragStart=s=>{s.currentTarget.contains(s.target)&&O(s)}}else{l.onMouseDown=r=>{if(r.button!==0||!r.currentTarget.contains(r.target))return;if(X(r.currentTarget)&&r.preventDefault(),e.ignoreEmulatedMouseEvents){r.stopPropagation();return}e.isPressed=!0,e.isOverTarget=!0,e.target=r.currentTarget,e.pointerType=J(r.nativeEvent)?"virtual":"mouse",!c&&!p&&A(r.currentTarget),x(r,e.pointerType)&&r.stopPropagation(),C(k(r.currentTarget),"mouseup",o,!1)},l.onMouseEnter=r=>{if(!r.currentTarget.contains(r.target))return;let s=!0;e.isPressed&&!e.ignoreEmulatedMouseEvents&&e.pointerType!=null&&(e.isOverTarget=!0,s=x(r,e.pointerType)),s&&r.stopPropagation()},l.onMouseLeave=r=>{if(!r.currentTarget.contains(r.target))return;let s=!0;e.isPressed&&!e.ignoreEmulatedMouseEvents&&e.pointerType!=null&&(e.isOverTarget=!1,s=y(r,e.pointerType,!1),D(r)),s&&r.stopPropagation()},l.onMouseUp=r=>{r.currentTarget.contains(r.target)&&!e.ignoreEmulatedMouseEvents&&r.button===0&&K(r,e.pointerType||"mouse")};let o=r=>{if(r.button===0){if(e.isPressed=!1,F(),e.ignoreEmulatedMouseEvents){e.ignoreEmulatedMouseEvents=!1;return}e.target&&H(r,e.target)&&e.pointerType!=null?y(M(e.target,r),e.pointerType):e.target&&e.isOverTarget&&e.pointerType!=null&&y(M(e.target,r),e.pointerType,!1),e.isOverTarget=!1}};l.onTouchStart=r=>{if(!r.currentTarget.contains(r.target))return;let s=ke(r.nativeEvent);if(!s)return;e.activePointerId=s.identifier,e.ignoreEmulatedMouseEvents=!0,e.isOverTarget=!0,e.isPressed=!0,e.target=r.currentTarget,e.pointerType="touch",!c&&!p&&A(r.currentTarget),P||Z(e.target),x(r,e.pointerType)&&r.stopPropagation(),C(j(r.currentTarget),"scroll",g,!0)},l.onTouchMove=r=>{if(!r.currentTarget.contains(r.target))return;if(!e.isPressed){r.stopPropagation();return}let s=re(r.nativeEvent,e.activePointerId),T=!0;s&&H(s,r.currentTarget)?!e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!0,T=x(r,e.pointerType)):e.isOverTarget&&e.pointerType!=null&&(e.isOverTarget=!1,T=y(r,e.pointerType,!1),D(r)),T&&r.stopPropagation()},l.onTouchEnd=r=>{if(!r.currentTarget.contains(r.target))return;if(!e.isPressed){r.stopPropagation();return}let s=re(r.nativeEvent,e.activePointerId),T=!0;s&&H(s,r.currentTarget)&&e.pointerType!=null?(K(r,e.pointerType),T=y(r,e.pointerType)):e.isOverTarget&&e.pointerType!=null&&(T=y(r,e.pointerType,!1)),T&&r.stopPropagation(),e.isPressed=!1,e.activePointerId=null,e.isOverTarget=!1,e.ignoreEmulatedMouseEvents=!0,e.target&&!P&&U(e.target),F()},l.onTouchCancel=r=>{r.currentTarget.contains(r.target)&&(r.stopPropagation(),e.isPressed&&O(r))};let g=r=>{e.isPressed&&r.target.contains(e.target)&&O({currentTarget:e.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};l.onDragStart=r=>{r.currentTarget.contains(r.target)&&O(r)}}return l},[C,c,p,F,P,O,D,y,x,K]);return v.useEffect(()=>()=>{var e;P||U((e=h.current.target)!==null&&e!==void 0?e:void 0)},[P]),{isPressed:f||d,pressProps:ae(m,le)}}function q(t){return t.tagName==="A"&&t.hasAttribute("href")}function W(t,n){const{key:a,code:u}=t,i=n,$=i.getAttribute("role");return(a==="Enter"||a===" "||a==="Spacebar"||u==="Space")&&!(i instanceof j(i).HTMLInputElement&&!ue(i,a)||i instanceof j(i).HTMLTextAreaElement||i.isContentEditable)&&!(($==="link"||!$&&q(i))&&a!=="Enter")}function ke(t){const{targetTouches:n}=t;return n.length>0?n[0]:null}function re(t,n){const a=t.changedTouches;for(let u=0;u<a.length;u++){const i=a[u];if(i.identifier===n)return i}return null}function M(t,n){return{currentTarget:t,shiftKey:n.shiftKey,ctrlKey:n.ctrlKey,metaKey:n.metaKey,altKey:n.altKey}}function Ce(t){let n=0,a=0;return t.width!==void 0?n=t.width/2:t.radiusX!==void 0&&(n=t.radiusX),t.height!==void 0?a=t.height/2:t.radiusY!==void 0&&(a=t.radiusY),{top:t.clientY-a,right:t.clientX+n,bottom:t.clientY+a,left:t.clientX-n}}function Oe(t,n){return!(t.left>n.right||n.left>t.right||t.top>n.bottom||n.top>t.bottom)}function H(t,n){let a=n.getBoundingClientRect(),u=Ce(t);return Oe(a,u)}function X(t){return!(t instanceof HTMLElement)||!t.hasAttribute("draggable")}function ne(t,n){return t instanceof HTMLInputElement?!ue(t,n):t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!q(t)}const we=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function ue(t,n){return t.type==="checkbox"||t.type==="radio"?n===" ":we.has(t.type)}function Fe(t){let{isDisabled:n,onFocus:a,onBlur:u,onFocusChange:i}=t;const $=v.useCallback(p=>{if(p.target===p.currentTarget)return u&&u(p),i&&i(!1),!0},[u,i]),c=ge($),f=v.useCallback(p=>{const b=k(p.target);p.target===p.currentTarget&&b.activeElement===p.target&&(a&&a(p),i&&i(!0),c(p))},[i,a,c]);return{focusProps:{onFocus:!n&&(a||i||u)?f:void 0,onBlur:!n&&(u||i)?$:void 0}}}let B=!1,Y=0;function N(){B=!0,setTimeout(()=>{B=!1},50)}function se(t){t.pointerType==="touch"&&N()}function Ke(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",se):document.addEventListener("touchend",N),Y++,()=>{Y--,!(Y>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",se):document.removeEventListener("touchend",N))}}function Ue(t){let{onHoverStart:n,onHoverChange:a,onHoverEnd:u,isDisabled:i}=t,[$,c]=v.useState(!1),f=v.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;v.useEffect(Ke,[]);let{hoverProps:p,triggerHoverEnd:b}=v.useMemo(()=>{let P=(d,S)=>{if(f.pointerType=S,i||S==="touch"||f.isHovered||!d.currentTarget.contains(d.target))return;f.isHovered=!0;let h=d.currentTarget;f.target=h,n&&n({type:"hoverstart",target:h,pointerType:S}),a&&a(!0),c(!0)},w=(d,S)=>{if(f.pointerType="",f.target=null,S==="touch"||!f.isHovered)return;f.isHovered=!1;let h=d.currentTarget;u&&u({type:"hoverend",target:h,pointerType:S}),a&&a(!1),c(!1)},m={};return typeof PointerEvent<"u"?(m.onPointerEnter=d=>{B&&d.pointerType==="mouse"||P(d,d.pointerType)},m.onPointerLeave=d=>{!i&&d.currentTarget.contains(d.target)&&w(d,d.pointerType)}):(m.onTouchStart=()=>{f.ignoreEmulatedMouseEvents=!0},m.onMouseEnter=d=>{!f.ignoreEmulatedMouseEvents&&!B&&P(d,"mouse"),f.ignoreEmulatedMouseEvents=!1},m.onMouseLeave=d=>{!i&&d.currentTarget.contains(d.target)&&w(d,"mouse")}),{hoverProps:m,triggerHoverEnd:w}},[n,a,u,i,f]);return v.useEffect(()=>{i&&b({currentTarget:f.target},f.pointerType)},[i]),{hoverProps:p,isHovered:$}}function Ge(t={}){let{autoFocus:n=!1,isTextInput:a,within:u}=t,i=v.useRef({isFocused:!1,isFocusVisible:n||ve()}),[$,c]=v.useState(!1),[f,p]=v.useState(()=>i.current.isFocused&&i.current.isFocusVisible),b=v.useCallback(()=>p(i.current.isFocused&&i.current.isFocusVisible),[]),P=v.useCallback(d=>{i.current.isFocused=d,c(d),b()},[b]);Te(d=>{i.current.isFocusVisible=d,b()},[],{isTextInput:a});let{focusProps:w}=Fe({isDisabled:u,onFocusChange:P}),{focusWithinProps:m}=$e({isDisabled:!u,onFocusWithinChange:P});return{isFocused:$,isFocusVisible:f,focusProps:u?m:w}}export{Ue as $,Se as _,Ge as a,Ae as b,Fe as c,ye as d};
