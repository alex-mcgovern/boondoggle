import{g as xe,a as Me,b as Se,c as Ee,l as te,j as ke,k as X}from"./SelectionManager-DRJezi5J.js";import{a as H,i as z,c as W,g as Z,f as Ke,n as L,b as Ce,o as Te,j as Re,$ as ne,d as re,p as we}from"./utils-9Msfu4Q8.js";import{a as Oe,b as De,c as Ie,d as Fe,$ as Ae}from"./Separator-BABTMdWU.js";import{r as s,R as y}from"./index-DVXBtNgz.js";import{c as oe,d as I,l as Be}from"./Dialog-DfWb5CGM.js";import{a as ae}from"./Text-BooAsC7s.js";import{c as N,h as _e,i as He}from"./focusSafely-Cv_PksxV.js";import{$ as se}from"./useResizeObserver-B8nJL-Cs.js";import{$ as Le}from"./PressResponder-DljVG33T.js";import{b as Ne,$ as j,c as Ue,a as ie}from"./useFocusRing-DXKnJiZy.js";import{a as Ve}from"./OverlayArrow-CgTapia-.js";import{$ as ze}from"./useMenuTrigger-CfwA40fZ.js";import{$ as We,a as Xe}from"./openLink-D2-6eagY.js";import{b as je}from"./useFocusable-BlmBqszO.js";import{$ as Ye}from"./context-COxT6_Ys.js";import{$ as Ge}from"./useControlledState-DO5k2rCg.js";import{a as qe}from"./FocusScope-DN4figbQ.js";const le=new WeakMap;function Je(t,e,n){let{shouldFocusWrap:a=!0,onKeyDown:r,onKeyUp:l,...o}=t;!t["aria-label"]&&!t["aria-labelledby"]&&console.warn("An aria-label or aria-labelledby prop is required for accessibility.");let i=N(t,{labelable:!0}),{listProps:c}=Oe({...o,ref:n,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,shouldFocusWrap:a,linkBehavior:"override"});return le.set(e,{onClose:t.onClose,onAction:t.onAction}),{menuProps:H(i,{onKeyDown:r,onKeyUp:l},{role:"menu",...c,onKeyDown:f=>{f.key!=="Escape"&&c.onKeyDown(f)}})}}function ce(t,e,n){let{key:a,closeOnSelect:r,isVirtualized:l,"aria-haspopup":o,onPressStart:i,onPressUp:c,onPress:f,onPressChange:p,onPressEnd:d,onHoverStart:$,onHoverChange:g,onHoverEnd:m,onKeyDown:b,onKeyUp:K,onFocus:S,onFocusChange:E,onBlur:C}=t,P=!!o;var k;let v=(k=t.isDisabled)!==null&&k!==void 0?k:e.selectionManager.isDisabled(a);var x;let u=(x=t.isSelected)!==null&&x!==void 0?x:e.selectionManager.isSelected(a),R=le.get(e),M=e.collection.getItem(a),T=t.onClose||R.onClose,U=We(),D=h=>{var V;P||(!(M==null||(V=M.props)===null||V===void 0)&&V.onAction&&M.props.onAction(),t.onAction?t.onAction(a):R.onAction&&R.onAction(a),h.target instanceof HTMLAnchorElement&&U.open(h.target,h,M.props.href,M.props.routerOptions))},w="menuitem";P||(e.selectionManager.selectionMode==="single"?w="menuitemradio":e.selectionManager.selectionMode==="multiple"&&(w="menuitemcheckbox"));let O=z(),q=z(),J=z(),A={"aria-disabled":v||void 0,role:w,"aria-label":t["aria-label"],"aria-labelledby":O,"aria-describedby":[q,J].filter(Boolean).join(" ")||void 0,"aria-controls":t["aria-controls"],"aria-haspopup":o,"aria-expanded":t["aria-expanded"]};e.selectionManager.selectionMode!=="none"&&!P&&(A["aria-checked"]=u),l&&(A["aria-posinset"]=M==null?void 0:M.index,A["aria-setsize"]=De(e.collection));let pe=h=>{h.pointerType==="keyboard"&&D(h),i==null||i(h)},be=h=>{h.pointerType!=="keyboard"&&(D(h),!P&&T&&(r??(e.selectionManager.selectionMode!=="multiple"||e.selectionManager.isLink(a)))&&T()),c==null||c(h)},{itemProps:B,isFocused:$e}=xe({selectionManager:e.selectionManager,key:a,ref:n,shouldSelectOnPressUp:!0,allowsDifferentPressOrigin:!0,linkBehavior:"none"}),{pressProps:me,isPressed:ge}=Ne({onPressStart:pe,onPress:f,onPressUp:be,onPressChange:p,onPressEnd:d,isDisabled:v}),{hoverProps:ye}=j({isDisabled:v,onHoverStart(h){_e()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(a)),$==null||$(h)},onHoverChange:g,onHoverEnd:m}),{keyboardProps:ve}=je({onKeyDown:h=>{if(h.repeat){h.continuePropagation();return}switch(h.key){case" ":!v&&e.selectionManager.selectionMode==="none"&&!P&&r!==!1&&T&&T();break;case"Enter":!v&&r!==!1&&!P&&T&&T();break;default:P||h.continuePropagation(),b==null||b(h);break}},onKeyUp:K}),{focusProps:he}=Ue({onBlur:C,onFocus:S,onFocusChange:E}),Q=N(M.props);delete Q.id;let Pe=Xe(M.props);return{menuItemProps:{...A,...H(Q,Pe,P?{onFocus:B.onFocus,"data-key":B["data-key"]}:B,me,ye,ve,he),tabIndex:B.tabIndex!=null?-1:void 0},labelProps:{id:O},descriptionProps:{id:q},keyboardShortcutProps:{id:J},isFocused:$e,isSelected:u,isPressed:ge,isDisabled:v}}function Qe(t){let{heading:e,"aria-label":n}=t,a=W();return{itemProps:{role:"presentation"},headingProps:e?{id:a,role:"presentation"}:{},groupProps:{role:"group","aria-label":n,"aria-labelledby":e?a:void 0}}}const _=2,Ze=50,et=1e3,ee=Math.PI/12;function tt(t){let{menuRef:e,submenuRef:n,isOpen:a,isDisabled:r}=t,l=s.useRef(),o=s.useRef(),i=s.useRef(0),c=s.useRef(),f=s.useRef(),p=s.useRef(),d=s.useRef(2),[$,g]=s.useState(!1);se({ref:n,onResize:()=>{n.current&&(o.current=n.current.getBoundingClientRect(),p.current=void 0)}});let b=()=>{g(!1),d.current=_,l.current=void 0},K=He();s.useEffect(()=>{$&&e.current?e.current.style.pointerEvents="none":e.current.style.pointerEvents=""},[e,$]),s.useEffect(()=>{let S=n.current,E=e.current;if(r||!S||!a||K!=="pointer"){b();return}o.current=S.getBoundingClientRect();let C=P=>{if(P.pointerType==="touch"||P.pointerType==="pen")return;let k=Date.now();if(k-i.current<Ze)return;clearTimeout(c.current),clearTimeout(f.current);let{clientX:v,clientY:x}=P;if(!l.current){l.current={x:v,y:x};return}if(!o.current)return;if(p.current||(p.current=v>o.current.right?"left":"right"),v<E.getBoundingClientRect().left||v>E.getBoundingClientRect().right||x<E.getBoundingClientRect().top||x>E.getBoundingClientRect().bottom){b();return}let u=l.current.x,R=l.current.y,M=p.current==="right"?o.current.left-u:u-o.current.right,T=Math.atan2(R-o.current.top,M)+ee,U=Math.atan2(R-o.current.bottom,M)-ee,D=Math.atan2(R-x,p.current==="left"?-(v-u):v-u),w=D<T&&D>U;d.current=w?Math.min(d.current+1,_):Math.max(d.current-1,0),d.current>=_?g(!0):g(!1),i.current=k,l.current={x:v,y:x},w&&(c.current=setTimeout(()=>{b(),f.current=setTimeout(()=>{let O=document.elementFromPoint(v,x);O&&E.contains(O)&&O.dispatchEvent(new PointerEvent("pointerover",{bubbles:!0,cancelable:!0}))},100)},et))};return window.addEventListener("pointermove",C),()=>{window.removeEventListener("pointermove",C),clearTimeout(c.current),clearTimeout(f.current),d.current=_}},[r,a,e,K,g,n])}function nt(t,e,n){let{parentMenuRef:a,submenuRef:r,type:l="menu",isDisabled:o,node:i,delay:c=200}=t,f=W(),p=W(),{direction:d}=Ye(),$=s.useRef(),g=s.useCallback(()=>{$.current&&(clearTimeout($.current),$.current=void 0)},[$]),m=Z(u=>{g(),e.open(u)}),b=Z(()=>{g(),e.close()});Ke(()=>()=>{g()},[g]);let K=u=>{switch(u.key){case"ArrowLeft":d==="ltr"&&u.currentTarget.contains(u.target)&&(u.stopPropagation(),b(),n.current.focus());break;case"ArrowRight":d==="rtl"&&u.currentTarget.contains(u.target)&&(u.stopPropagation(),b(),n.current.focus());break;case"Escape":u.stopPropagation(),e.closeAll();break}},S={id:p,"aria-label":i.textValue,submenuLevel:e.submenuLevel,...l==="menu"&&{onClose:e.closeAll,autoFocus:e.focusStrategy,onKeyDown:K}},E=u=>{switch(u.key){case"ArrowRight":o||(d==="ltr"?(e.isOpen||m("first"),l==="menu"&&(r!=null&&r.current)&&document.activeElement===(n==null?void 0:n.current)&&r.current.focus()):e.isOpen?b():u.continuePropagation());break;case"ArrowLeft":o||(d==="rtl"?(e.isOpen||m("first"),l==="menu"&&(r!=null&&r.current)&&document.activeElement===(n==null?void 0:n.current)&&r.current.focus()):e.isOpen?b():u.continuePropagation());break;case"Escape":e.closeAll();break;default:u.continuePropagation();break}},C=u=>{!o&&(u.pointerType==="virtual"||u.pointerType==="keyboard")&&m("first")},P=u=>{!o&&(u.pointerType==="touch"||u.pointerType==="mouse")&&m()},k=u=>{o||(u&&!e.isOpen?$.current||($.current=setTimeout(()=>{m()},c)):u||g())},v=u=>{e.isOpen&&a.current.contains(u.relatedTarget)&&b()},x=u=>u!==n.current;return tt({menuRef:a,submenuRef:r,isOpen:e.isOpen,isDisabled:o}),{submenuTriggerProps:{id:f,"aria-controls":e.isOpen?p:void 0,"aria-haspopup":o?void 0:l,"aria-expanded":e.isOpen?"true":"false",onPressStart:C,onPress:P,onHoverChange:k,onKeyDown:E,onBlur:v,isOpen:e.isOpen},submenuProps:S,popoverProps:{isNonModal:!0,disableFocusManagement:!0,shouldCloseOnInteractOutside:x}}}function rt(t){let e=Ve(t),[n,a]=s.useState(null),[r,l]=s.useState([]),o=()=>{l([]),e.close()};return{focusStrategy:n,...e,open(f=null){a(f),e.open()},toggle(f=null){a(f),e.toggle()},close(){o()},expandedKeysStack:r,openSubmenu:(f,p)=>{l(d=>p>d.length?d:[...d.slice(0,p),f])},closeSubmenu:(f,p)=>{l(d=>d[p]===f?d.slice(0,p):d)}}}function ot(t,e){let{triggerKey:n}=t,{expandedKeysStack:a,openSubmenu:r,closeSubmenu:l,close:o}=e,[i]=s.useState(a==null?void 0:a.length),c=s.useMemo(()=>a[i]===n,[a,n,i]),[f,p]=s.useState(null),d=s.useCallback((m=null)=>{p(m),r(n,i)},[r,i,n]),$=s.useCallback(()=>{p(null),l(n,i)},[l,i,n]),g=s.useCallback((m=null)=>{p(m),c?$():d(m)},[$,d,c]);return s.useMemo(()=>({focusStrategy:f,isOpen:c,open:d,close:$,closeAll:o,submenuLevel:i,setOpen:()=>{},toggle:g}),[c,d,$,o,f,g,i])}class at{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let n=this.keyMap.get(e);return n?n.prevKey:null}getKeyAfter(e){let n=this.keyMap.get(e);return n?n.nextKey:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){return this.keyMap.get(e)}at(e){const n=[...this.getKeys()];return this.getItem(n[e])}constructor(e,{expandedKeys:n}={}){this.keyMap=new Map,this.iterable=e,n=n||new Set;let a=o=>{if(this.keyMap.set(o.key,o),o.childNodes&&(o.type==="section"||n.has(o.key)))for(let i of o.childNodes)a(i)};for(let o of e)a(o);let r,l=0;for(let[o,i]of this.keyMap)r?(r.nextKey=o,i.prevKey=r.key):(this.firstKey=o,i.prevKey=void 0),i.type==="item"&&(i.index=l++),r=i,r.nextKey=void 0;this.lastKey=r==null?void 0:r.key}}function st(t){let{onExpandedChange:e}=t,[n,a]=Ge(t.expandedKeys?new Set(t.expandedKeys):void 0,t.defaultExpandedKeys?new Set(t.defaultExpandedKeys):new Set,e),r=Me(t),l=s.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),o=Se(t,s.useCallback(c=>new at(c,{expandedKeys:n}),[n]),null);return s.useEffect(()=>{r.focusedKey!=null&&!o.getItem(r.focusedKey)&&r.setFocusedKey(null)},[o,r.focusedKey]),{collection:o,expandedKeys:n,disabledKeys:l,toggleKey:c=>{a(it(n,c))},setExpandedKeys:a,selectionManager:new Ee(o,r)}}function it(t,e){let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n}const ue=s.createContext({}),Y=s.createContext(null),F=s.createContext(null),G=s.createContext(null);function Rt(t){let e=rt(t),n=s.useRef(null),{menuTriggerProps:a,menuProps:r}=ze({...t,type:"menu"},e,n),[l,o]=s.useState(null),i=s.useCallback(()=>{n.current&&o(n.current.offsetWidth+"px")},[n]);return se({ref:n,onResize:i}),y.createElement(L,{values:[[Y,r],[oe,e],[G,e],[I,{trigger:"MenuTrigger",triggerRef:n,placement:"bottom start",style:{"--trigger-width":l}}]]},y.createElement(Le,{...a,ref:n,isPressed:e.isOpen},t.children))}function wt(t,e){return te("submenutrigger",t,e,t.children,t.children[0])}function de(t){let{item:e,parentMenuRef:n}=t,a=s.useContext(F);return X({items:a.collection.getChildren(e.key),children:l=>{switch(l.type){case"item":return y.createElement(ft,{item:l,popover:e.rendered[1],parentMenuRef:n,delay:e.props.delay});default:throw new Error("Unsupported element type in SubmenuTrigger: "+e.type)}}})}function lt(t,e){[t,e]=Ce(t,e,Y);let{portal:n,collection:a}=ke(t);return y.createElement(y.Fragment,null,a.size>0&&y.createElement(ct,{props:t,collection:a,menuRef:e}),n)}function ct({props:t,collection:e,menuRef:n}){let a=st({...t,collection:e,children:void 0}),[r,l]=s.useState(null),{menuProps:o}=Je(t,a,n),i=s.useContext(G),c=s.useContext(I),f=X({items:a.collection,children:b=>{switch(b.type){case"section":return y.createElement(ut,{section:b,parentMenuRef:n});case"separator":return y.createElement(Ie,b.props);case"item":return y.createElement(fe,{item:b});case"submenutrigger":return y.createElement(de,{item:b,parentMenuRef:n});default:throw new Error("Unsupported node type in Menu: "+b.type)}}}),p=(c==null?void 0:c.trigger)==="SubmenuTrigger";Be({ref:n,onInteractOutside:b=>{i&&!(r!=null&&r.contains(b.target))&&i.close()},isDisabled:p||(i==null?void 0:i.expandedKeysStack.length)===0});let d=s.useRef(null),[$,g]=s.useState({left:0});s.useEffect(()=>{if(r&&d.current!==r&&$.left===0){d.current=r;let{left:b}=r.getBoundingClientRect();g({left:-1*b})}},[$,r]);var m;return y.createElement(qe,null,y.createElement("div",{...N(t),...o,ref:n,slot:t.slot||void 0,onScroll:t.onScroll,style:t.style,className:(m=t.className)!==null&&m!==void 0?m:"react-aria-Menu"},y.createElement(L,{values:[[F,a],[Fe,{elementType:"div"}],[I,{UNSTABLE_portalContainer:r||void 0}]]},f)),y.createElement("div",{ref:l,style:{width:"100vw",position:"absolute",top:0,...$}}))}const Ot=s.forwardRef(lt);function ut({section:t,className:e,style:n,parentMenuRef:a,...r}){var l,o;let i=s.useContext(F),[c,f]=Te();var p;let{headingProps:d,groupProps:$}=Qe({heading:f,"aria-label":(p=t["aria-label"])!==null&&p!==void 0?p:void 0}),g=X({items:i.collection.getChildren(t.key),children:m=>{switch(m.type){case"header":{let{ref:b,...K}=m.props;return y.createElement(Ae,{...d,...K,ref:Re(c,b)},m.rendered)}case"item":return y.createElement(fe,{item:m});case"submenutrigger":return y.createElement(de,{item:m,parentMenuRef:a});default:throw new Error("Unsupported element type in Section: "+m.type)}}});return y.createElement("section",{...N(r),...$,className:e||((l=t.props)===null||l===void 0?void 0:l.className)||"react-aria-Section",style:n||((o=t.props)===null||o===void 0?void 0:o.style),ref:t.props.ref},g)}function dt(t,e){return te("item",t,e,t.children)}const Dt=s.forwardRef(dt);function fe({item:t}){var e;let n=s.useContext(F),a=ne(t.props.ref),{menuItemProps:r,labelProps:l,descriptionProps:o,keyboardShortcutProps:i,...c}=ce({key:t.key,"aria-label":(e=t.props)===null||e===void 0?void 0:e["aria-label"]},n,a),f=t.props,{isFocusVisible:p,focusProps:d}=ie(),{hoverProps:$,isHovered:g}=j({isDisabled:c.isDisabled,onHoverStart:t.props.onHoverStart,onHoverChange:t.props.onHoverChange,onHoverEnd:t.props.onHoverEnd}),m=re({...f,id:void 0,children:t.rendered,defaultClassName:"react-aria-MenuItem",values:{...c,isHovered:g,isFocusVisible:p,selectionMode:n.selectionManager.selectionMode,selectionBehavior:n.selectionManager.selectionBehavior,hasSubmenu:!1,isOpen:!1}}),b=f.href?"a":"div";return y.createElement(b,{...H(r,d,$),...m,ref:a,"data-disabled":c.isDisabled||void 0,"data-hovered":g||void 0,"data-focused":c.isFocused||void 0,"data-focus-visible":p||void 0,"data-pressed":c.isPressed||void 0,"data-selected":c.isSelected||void 0,"data-selection-mode":n.selectionManager.selectionMode==="none"?void 0:n.selectionManager.selectionMode},y.createElement(L,{values:[[ae,{slots:{label:l,description:o}}],[ue,i]]},m.children))}function ft({item:t,popover:e,parentMenuRef:n,delay:a}){let r=s.useContext(F),l=we(I),o=ne(t.props.ref),i=s.useContext(G),c=ot({triggerKey:t.key},i),f=s.useRef(null),{submenuTriggerProps:p,submenuProps:d,popoverProps:$}=nt({node:t,parentMenuRef:n,submenuRef:f,delay:a},c,o),{menuItemProps:g,labelProps:m,descriptionProps:b,keyboardShortcutProps:K,...S}=ce({key:t.key,...p},r,o),E=t.props,{hoverProps:C,isHovered:P}=j({isDisabled:S.isDisabled}),{isFocusVisible:k,focusProps:v}=ie(),x=re({...E,id:void 0,children:t.rendered,defaultClassName:"react-aria-MenuItem",values:{...S,isHovered:P,isFocusVisible:k,selectionMode:r.selectionManager.selectionMode,selectionBehavior:r.selectionManager.selectionBehavior,hasSubmenu:!0,isOpen:c.isOpen}});return y.createElement(L,{values:[[ae,{slots:{label:m,description:b}}],[ue,K],[Y,d],[oe,c],[I,{ref:f,trigger:"SubmenuTrigger",triggerRef:o,placement:"end top",UNSTABLE_portalContainer:l.UNSTABLE_portalContainer||void 0,...$}]]},y.createElement("div",{...H(g,v,C),...x,ref:o,"data-disabled":S.isDisabled||void 0,"data-hovered":P||void 0,"data-focused":S.isFocused||void 0,"data-focus-visible":k||void 0,"data-pressed":S.isPressed||void 0,"data-selected":S.isSelected||void 0,"data-selection-mode":r.selectionManager.selectionMode==="none"?void 0:r.selectionManager.selectionMode,"data-has-submenu":!0,"data-open":c.isOpen||void 0},x.children),e)}export{Rt as $,wt as a,Ot as b,Dt as c};
