import{$ as s}from"./isScrollable-Bts8_1NI.js";class a{isDisabled(t){var e;return this.disabledBehavior==="all"&&(((e=t.props)===null||e===void 0?void 0:e.isDisabled)||this.disabledKeys.has(t.key))}getNextKey(t){for(t=this.collection.getKeyAfter(t);t!=null;){let e=this.collection.getItem(t);if(e.type==="item"&&!this.isDisabled(e))return t;t=this.collection.getKeyAfter(t)}return null}getPreviousKey(t){for(t=this.collection.getKeyBefore(t);t!=null;){let e=this.collection.getItem(t);if(e.type==="item"&&!this.isDisabled(e))return t;t=this.collection.getKeyBefore(t)}return null}findKey(t,e,i){let n=this.getItem(t);if(!n)return null;let l=n.getBoundingClientRect();do t=e(t),n=this.getItem(t);while(n&&i(l,n.getBoundingClientRect()));return t}isSameRow(t,e){return t.top===e.top||t.left!==e.left}isSameColumn(t,e){return t.left===e.left||t.top!==e.top}getKeyBelow(t){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(t,e=>this.getNextKey(e),this.isSameRow):this.getNextKey(t)}getKeyAbove(t){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(t,e=>this.getPreviousKey(e),this.isSameRow):this.getPreviousKey(t)}getNextColumn(t,e){return e?this.getPreviousKey(t):this.getNextKey(t)}getKeyRightOf(t){return this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(t,this.direction==="rtl"):this.findKey(t,e=>this.getNextColumn(e,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(t,this.direction==="rtl"):null}getKeyLeftOf(t){return this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(t,this.direction==="ltr"):this.findKey(t,e=>this.getNextColumn(e,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(t,this.direction==="ltr"):null}getFirstKey(){let t=this.collection.getFirstKey();for(;t!=null;){let e=this.collection.getItem(t);if((e==null?void 0:e.type)==="item"&&!this.isDisabled(e))return t;t=this.collection.getKeyAfter(t)}return null}getLastKey(){let t=this.collection.getLastKey();for(;t!=null;){let e=this.collection.getItem(t);if(e.type==="item"&&!this.isDisabled(e))return t;t=this.collection.getKeyBefore(t)}return null}getItem(t){return t!==null?this.ref.current.querySelector(`[data-key="${CSS.escape(t.toString())}"]`):null}getKeyPageAbove(t){let e=this.ref.current,i=this.getItem(t);if(!i)return null;if(!s(e))return this.getFirstKey();let n=e.getBoundingClientRect(),l=i.getBoundingClientRect();if(this.orientation==="horizontal"){let o=n.x-e.scrollLeft,r=Math.max(0,l.x-o+l.width-n.width);for(;i&&l.x-o>r;)t=this.getKeyAbove(t),i=t==null?null:this.getItem(t),l=i==null?void 0:i.getBoundingClientRect()}else{let o=n.y-e.scrollTop,r=Math.max(0,l.y-o+l.height-n.height);for(;i&&l.y-o>r;)t=this.getKeyAbove(t),i=t==null?null:this.getItem(t),l=i==null?void 0:i.getBoundingClientRect()}return t??this.getFirstKey()}getKeyPageBelow(t){let e=this.ref.current,i=this.getItem(t);if(!i)return null;if(!s(e))return this.getLastKey();let n=e.getBoundingClientRect(),l=i.getBoundingClientRect();if(this.orientation==="horizontal"){let o=n.x-e.scrollLeft,r=Math.min(e.scrollWidth,l.x-o-l.width+n.width);for(;i&&l.x-o<r;)t=this.getKeyBelow(t),i=t==null?null:this.getItem(t),l=i==null?void 0:i.getBoundingClientRect()}else{let o=n.y-e.scrollTop,r=Math.min(e.scrollHeight,l.y-o-l.height+n.height);for(;i&&l.y-o<r;)t=this.getKeyBelow(t),i=t==null?null:this.getItem(t),l=i==null?void 0:i.getBoundingClientRect()}return t??this.getLastKey()}getKeyForSearch(t,e){if(!this.collator)return null;let i=this.collection,n=e||this.getFirstKey();for(;n!=null;){let l=i.getItem(n),o=l.textValue.slice(0,t.length);if(l.textValue&&this.collator.compare(o,t)===0)return n;n=this.getKeyBelow(n)}return null}constructor(...t){if(t.length===1){let e=t[0];this.collection=e.collection,this.ref=e.ref,this.collator=e.collator,this.disabledKeys=e.disabledKeys||new Set,this.disabledBehavior=e.disabledBehavior||"all",this.orientation=e.orientation,this.direction=e.direction,this.layout=e.layout||"stack"}else this.collection=t[0],this.disabledKeys=t[1],this.ref=t[2],this.collator=t[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all";this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}}export{a as $};
